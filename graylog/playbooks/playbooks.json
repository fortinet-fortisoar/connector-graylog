{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Graylog - 1.0.0",
      "description": "Sample playbooks for \"Graylog\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": null,
      "uuid": "0096c7e4-a695-45a6-8ee7-1103852ca646",
      "id": 129,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get System Lookup Tables",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a list of system lookup tables from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659693498,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7e464c32-95d2-4142-b28e-2b69ab2b52fd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "e38d7866-830b-4f5a-8733-9dd8a9c38356",
                "title": "GrayLog: Get System Lookup Tables",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7e464c32-95d2-4142-b28e-2b69ab2b52fd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get System Lookup Tables",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "sort": "title",
                  "order": false,
                  "query": "",
                  "resolve": false,
                  "per_page": 50
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_system_lookup_tables",
                "operationTitle": "Get System Lookup Tables",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "cca56d04-5ec2-4472-a764-85450f7fc2bf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get System Lookup Tables",
              "targetStep": "/api/3/workflow_steps/cca56d04-5ec2-4472-a764-85450f7fc2bf",
              "sourceStep": "/api/3/workflow_steps/7e464c32-95d2-4142-b28e-2b69ab2b52fd",
              "label": null,
              "isExecuted": false,
              "uuid": "cfcd44aa-7bce-4e79-87e1-e9104bb4a94f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "0699501b-2c05-4f42-bd6a-314133619c7f",
          "id": 1458,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Absolute",
          "aliasName": null,
          "tag": null,
          "description": "Search for a events in Graylog based on the input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684109,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fb051876-ac69-4783-8f9d-717d3f85cf61",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Search Absolute",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "sort": true,
                  "limit": 20,
                  "query": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa",
                  "fields": "",
                  "filter": "",
                  "offset": 0,
                  "decorate": true,
                  "end_time": "2022-08-04T18:30:00.000Z",
                  "start_time": "2022-08-03T18:30:00.000Z"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "search_absolute",
                "operationTitle": "Search Messages in Absolute Timerange",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c0eb4905-135f-41ec-915b-cb012a8b16a1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "b1f98ac5-6ff7-4613-93be-67bc75b63495",
                "title": "Graylog: Search Absolute",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "fb051876-ac69-4783-8f9d-717d3f85cf61"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Search Messages in Absolute Timerange",
              "targetStep": "/api/3/workflow_steps/c0eb4905-135f-41ec-915b-cb012a8b16a1",
              "sourceStep": "/api/3/workflow_steps/fb051876-ac69-4783-8f9d-717d3f85cf61",
              "label": null,
              "isExecuted": false,
              "uuid": "25102267-53ec-4dd7-b2d0-3fa960b998ce"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "10d3e6a4-15c9-4a90-9c56-2c2720896682",
          "id": 1441,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Node JVM",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve a JVM information of the node from Graylog based on the node ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684042,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c62c8798-edd3-4995-83c9-46cf42bf5cfb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Node JVM",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "id": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_node_jvm",
                "operationTitle": "Get Cluster Node JVM",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7853b270-30ac-4fc0-8a46-c4b581d930b5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "7b3eb109-4916-48d7-a9f3-e36a8f305ef5",
                "title": "Graylog: Get Cluster Node JVM",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "c62c8798-edd3-4995-83c9-46cf42bf5cfb"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Node JVM",
              "targetStep": "/api/3/workflow_steps/7853b270-30ac-4fc0-8a46-c4b581d930b5",
              "sourceStep": "/api/3/workflow_steps/c62c8798-edd3-4995-83c9-46cf42bf5cfb",
              "label": null,
              "isExecuted": false,
              "uuid": "d2a38664-1bfb-4e17-b077-40abc319885d"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "1ec0fad1-e9e9-42ac-8df0-976521f4422e",
          "id": 1442,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> GrayLog > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "This playbook demonstrate the list messages operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659699042,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a48acac5-4d0f-4a2b-9b3b-20433742d773",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "configuration",
              "description": null,
              "arguments": {
                "fetched_messages": "{{vars.steps.List_Messages}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "5bfea575-851e-4051-afce-ee5c7f07dfcd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Alert Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.List_Messages.macro_name}}",
                  "value": "{{vars.steps.List_Messages.curr_timestamp}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "6e185f6e-a47a-4ca7-8f9b-fb0e089fcd2d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.List_Messages.data}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.message._id}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "source": "GrayLog",
                  "status": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                  "severity": "/api/3/picklists/58d0753f-f7e4-403b-953c-b0f521eab759",
                  "sourceId": "{{vars.item.message._id}}",
                  "__replace": "true",
                  "sourceType": "{{vars.item.message.source}}",
                  "sourcedata": "{{vars.item | toJSON}}",
                  "description": "{{vars.item.message.message}}",
                  "ackSlaStatus": "/api/3/picklists/090115d7-90fc-4dc6-97ca-27950fc30c1c",
                  "closureReason": "/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                  "respSlaStatus": "/api/3/picklists/090115d7-90fc-4dc6-97ca-27950fc30c1c",
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "70d462c2-7b67-4de5-9ecf-99a82eb36ada"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6fc03f07-1d68-4a7b-b76b-f1e00eeaa59c",
                "title": "GrayLog > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a48acac5-4d0f-4a2b-9b3b-20433742d773"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Messages",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/cc9832d6-a0da-4b6c-8664-370c73a47234"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "ee48ffe0-d962-4944-a218-a3b5df618a1e"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Messages",
              "targetStep": "/api/3/workflow_steps/ee48ffe0-d962-4944-a218-a3b5df618a1e",
              "sourceStep": "/api/3/workflow_steps/a48acac5-4d0f-4a2b-9b3b-20433742d773",
              "label": null,
              "isExecuted": false,
              "uuid": "1ce8d3fe-9a3f-4388-afff-6aee3158657e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Update Last Alert Pull Time",
              "targetStep": "/api/3/workflow_steps/6e185f6e-a47a-4ca7-8f9b-fb0e089fcd2d",
              "sourceStep": "/api/3/workflow_steps/70d462c2-7b67-4de5-9ecf-99a82eb36ada",
              "label": null,
              "isExecuted": false,
              "uuid": "64556011-5fe2-4e79-aae7-959d11bae7ed"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Messages -> configuration",
              "targetStep": "/api/3/workflow_steps/5bfea575-851e-4051-afce-ee5c7f07dfcd",
              "sourceStep": "/api/3/workflow_steps/ee48ffe0-d962-4944-a218-a3b5df618a1e",
              "label": null,
              "isExecuted": false,
              "uuid": "a714db76-d07b-46a9-8813-157b626287e3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "configuration -> Create Record",
              "targetStep": "/api/3/workflow_steps/70d462c2-7b67-4de5-9ecf-99a82eb36ada",
              "sourceStep": "/api/3/workflow_steps/5bfea575-851e-4051-afce-ee5c7f07dfcd",
              "label": null,
              "isExecuted": false,
              "uuid": "a8cc064a-a6c5-4354-b92f-4ea2d9fb401a"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "4b1b89bd-0fb0-4d6e-82ec-d0990e0f1886",
          "id": 1443,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "ingest",
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alerts",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a list of alerts from Graylog",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684192,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/659b7f10-7617-42e9-b7e3-aa025fca9bdb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "42eafaf8-6bad-409f-ab82-207825413274",
                "title": "GrayLog: Get Alerts",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "659b7f10-7617-42e9-b7e3-aa025fca9bdb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "limit": 300,
                  "since": "0"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "81e56e4f-89c3-495f-a25f-41a1f00daf06"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/81e56e4f-89c3-495f-a25f-41a1f00daf06",
              "sourceStep": "/api/3/workflow_steps/659b7f10-7617-42e9-b7e3-aa025fca9bdb",
              "label": null,
              "isExecuted": false,
              "uuid": "8293a23c-d91a-43ff-82ec-1082fea00002"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "5a0d0267-add9-4195-adf1-04b72e8097bd",
          "id": 1444,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Node Metrics",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve all metrics for a specific node in the cluster from Graylog",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684588,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0deb08bd-53c1-4400-81bf-185d0155f3dc",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "f44e02fb-ff6b-4927-a281-de0d1fed7aba",
                "title": "GrayLog: Get Cluster Node Metrics",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "0deb08bd-53c1-4400-81bf-185d0155f3dc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Node Metrics",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "id": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa",
                  "metrics": ""
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_node_metrics",
                "operationTitle": "Get Cluster Node Metrics",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9f7af576-c97f-4242-96b0-7e3fa41f6faf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Node Metrics",
              "targetStep": "/api/3/workflow_steps/9f7af576-c97f-4242-96b0-7e3fa41f6faf",
              "sourceStep": "/api/3/workflow_steps/0deb08bd-53c1-4400-81bf-185d0155f3dc",
              "label": null,
              "isExecuted": false,
              "uuid": "3b2b164d-7353-4a32-a039-5c8fdcf98053"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "689f9540-de99-4c9e-85eb-764b18168cf9",
          "id": 1445,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Input States",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve a input states of the cluster from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684005,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/daad59e6-d02c-4d59-84f0-66bde54ce697",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "34cd09b0-432f-4085-900d-4ffd14d82172",
                "title": "Graylog: Get Cluster Input States",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "daad59e6-d02c-4d59-84f0-66bde54ce697"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Input States",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": [],
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_input_states",
                "operationTitle": "Get Cluster Input States",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f26b2c48-9b02-4e9f-b790-60ace5d46341"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Input States",
              "targetStep": "/api/3/workflow_steps/f26b2c48-9b02-4e9f-b790-60ace5d46341",
              "sourceStep": "/api/3/workflow_steps/daad59e6-d02c-4d59-84f0-66bde54ce697",
              "label": null,
              "isExecuted": false,
              "uuid": "37569178-ecb4-4025-91f4-3c550601d3f3"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "7489562a-57ba-454e-a6b1-e07254859612",
          "id": 1446,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Relative",
          "aliasName": null,
          "tag": null,
          "description": "Search for a messages in a universal relative timerange from Graylog based on the query, and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659683975,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4fa706ca-8f2c-4cde-a8e4-1a402431470c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "826e040d-cff8-4766-b405-30f18d3690d0",
                "title": "Graylog: Search Relative",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "4fa706ca-8f2c-4cde-a8e4-1a402431470c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Search Relative",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "sort": true,
                  "limit": 20,
                  "query": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa",
                  "fields": "",
                  "filter": "",
                  "offset": 0,
                  "decorate": true,
                  "time_range": ""
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "search_relative",
                "operationTitle": "Search Messages in Relative Timerange",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bd4b2224-bb0e-4eee-8b74-95e8858ced96"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Search Messages in Relative Timerange",
              "targetStep": "/api/3/workflow_steps/bd4b2224-bb0e-4eee-8b74-95e8858ced96",
              "sourceStep": "/api/3/workflow_steps/4fa706ca-8f2c-4cde-a8e4-1a402431470c",
              "label": null,
              "isExecuted": false,
              "uuid": "246f3403-ae97-4319-99c9-efd7a41ac29c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "81e8fd14-e8e7-4e27-a030-651b9e9b0555",
          "id": 1447,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Processing Status",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve a processing status of the cluster from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1657797346,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/64b74082-8499-413a-8bfe-5dbe984274c8",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9ec83739-f109-4709-948b-8dbad91a6ade",
                "title": "Graylog: Get Cluster Processing Status",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "64b74082-8499-413a-8bfe-5dbe984274c8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Processing Status",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": [],
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_processing_status",
                "operationTitle": "Get Cluster Processing Status",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "91d9524b-b1ec-496d-80a8-db4688205a6f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Processing Status",
              "targetStep": "/api/3/workflow_steps/91d9524b-b1ec-496d-80a8-db4688205a6f",
              "sourceStep": "/api/3/workflow_steps/64b74082-8499-413a-8bfe-5dbe984274c8",
              "label": null,
              "isExecuted": false,
              "uuid": "5f1e2710-b37d-49b8-9995-48448457ff3e"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "88ea085f-c61a-4069-8e94-7cd6a9b70975",
          "id": 1448,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Events",
          "aliasName": null,
          "tag": null,
          "description": "Search for a events in Graylog based on the input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659683898,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8d377ff5-3a32-4f24-b896-43ed99936e05",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4e768ecf-8b3f-470f-a498-93d2a2ee808c",
                "title": "Graylog: Search Events",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8d377ff5-3a32-4f24-b896-43ed99936e05"
            },
            {
              "@type": "WorkflowStep",
              "name": "Search Events",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "sort": false,
                  "limit": 20,
                  "query": "",
                  "filter": "",
                  "offset": 0,
                  "time_range": "3000000"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "search_events",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "b9581a23-cf78-4432-b05a-5f29e6222468"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Search Events",
              "targetStep": "/api/3/workflow_steps/b9581a23-cf78-4432-b05a-5f29e6222468",
              "sourceStep": "/api/3/workflow_steps/8d377ff5-3a32-4f24-b896-43ed99936e05",
              "label": null,
              "isExecuted": false,
              "uuid": "71cb69b3-1c4b-4045-963a-f9fd0efdb63f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9be33be8-085a-48e4-b662-e06db86a4f1e",
          "id": 1449,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Clusters Lookup Tables",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a list of clusters lookup tables from Graylog",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684810,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f24dcf14-f326-4c06-ac71-7aa406dde321",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Clusters Lookup Tables",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "id": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa",
                  "key": ""
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_lookup_tables",
                "operationTitle": "Get Clusters Lookup Tables",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9e231f56-da6c-48e3-b317-f14cf4942ed5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3bb6919b-ca8a-48df-875c-392079cc87c2",
                "title": "GrayLog: Get Clusters Lookup Tables",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "f24dcf14-f326-4c06-ac71-7aa406dde321"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Clusters Lookup Tables",
              "targetStep": "/api/3/workflow_steps/9e231f56-da6c-48e3-b317-f14cf4942ed5",
              "sourceStep": "/api/3/workflow_steps/f24dcf14-f326-4c06-ac71-7aa406dde321",
              "label": null,
              "isExecuted": false,
              "uuid": "b4dd6d6d-e45d-4a94-b19e-dc8146a3d0b6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9d1ec322-ec0e-4a38-ad33-8c5fe6cbd8a7",
          "id": 1450,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">>GrayLog > Init Macros",
          "aliasName": null,
          "tag": null,
          "description": "This playbook create Graylog macros if not exist.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "GrayLogMacroName",
            "GrayLogMacroValue",
            "overrideIfNoMatch"
          ],
          "synchronous": false,
          "lastModifyDate": 1659697745,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/442d0595-b89e-4bd6-b752-b118844d970c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Update Marco If Required",
              "description": null,
              "arguments": {
                "when": "{{(vars.input.params.overrideIfNoMatch == true) and (vars.macroExistingRecord.value != vars.input.params.GrayLogMacroValue)}}",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.GrayLogMacroName}}",
                  "body": "{ 'name': '{{vars.input.params.GrayLogMacroName}}'   , 'value': '{{vars.input.params.GrayLogMacroValue}}' }",
                  "method": "POST"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "0ef61980-6398-4075-be93-d84a831d56fd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "442d0595-b89e-4bd6-b752-b118844d970c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Macro Current Value",
              "description": null,
              "arguments": {
                "macroExistingRecord": "{{vars.steps.Get_GrayLog_Macros.data['hydra:member'][0]}}"
              },
              "status": null,
              "top": "435",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "917e61e5-0047-47c3-a999-01b29c293abf"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create GrayLog Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.GrayLogMacroName}}",
                  "body": "{ 'name': '{{vars.input.params.GrayLogMacroName}}'   , 'value': '{{vars.input.params.GrayLogMacroValue}}' }",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "cb421edc-cdb5-4410-9fe9-8d03b8ecd34f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get GrayLog Macros",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.GrayLogMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "ee676794-2d1c-4a42-8c56-fff09ff9747d"
            },
            {
              "@type": "WorkflowStep",
              "name": "GrayLog Macro Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/cb421edc-cdb5-4410-9fe9-8d03b8ecd34f",
                    "condition": "{{ vars.steps.Get_GrayLog_Macros.data['hydra:totalItems']==0 }}",
                    "step_name": "Create GrayLog Macro"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/917e61e5-0047-47c3-a999-01b29c293abf",
                    "step_name": "Fetch Macro Current Value"
                  }
                ]
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "f71952ed-1965-426d-93f4-26ea47304ea3"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Macro Current Value -> Update Marco If Required",
              "targetStep": "/api/3/workflow_steps/0ef61980-6398-4075-be93-d84a831d56fd",
              "sourceStep": "/api/3/workflow_steps/917e61e5-0047-47c3-a999-01b29c293abf",
              "label": null,
              "isExecuted": false,
              "uuid": "85f6aa0a-0328-49eb-affc-a699663e2241"
            },
            {
              "@type": "WorkflowRoute",
              "name": "GrayLog Macro Exists -> Create GrayLog Macro",
              "targetStep": "/api/3/workflow_steps/cb421edc-cdb5-4410-9fe9-8d03b8ecd34f",
              "sourceStep": "/api/3/workflow_steps/f71952ed-1965-426d-93f4-26ea47304ea3",
              "label": "No",
              "isExecuted": false,
              "uuid": "a8bc2c1a-0603-4a8b-891a-f0d475b64164"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get GrayLog Macros -> GrayLog Macro Exists",
              "targetStep": "/api/3/workflow_steps/f71952ed-1965-426d-93f4-26ea47304ea3",
              "sourceStep": "/api/3/workflow_steps/ee676794-2d1c-4a42-8c56-fff09ff9747d",
              "label": null,
              "isExecuted": false,
              "uuid": "c48f3991-2849-448f-a1fa-804e48ee36e5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get GrayLog Macros",
              "targetStep": "/api/3/workflow_steps/ee676794-2d1c-4a42-8c56-fff09ff9747d",
              "sourceStep": "/api/3/workflow_steps/442d0595-b89e-4bd6-b752-b118844d970c",
              "label": null,
              "isExecuted": false,
              "uuid": "cec57fee-c97b-46bb-a65d-6886313bf1a4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "GrayLog Macro Exists -> Fetch Macro Current Value",
              "targetStep": "/api/3/workflow_steps/917e61e5-0047-47c3-a999-01b29c293abf",
              "sourceStep": "/api/3/workflow_steps/f71952ed-1965-426d-93f4-26ea47304ea3",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "fb08f2ad-7241-4c56-b7d7-9027c3027710"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9f0da8c4-e4e6-41b9-9584-38f8a50cbc2c",
          "id": 1451,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Metrics",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve all metrics of all nodes in the cluster from Graylog",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684314,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7d8e58fd-5f12-4c4c-b4d0-beeb5bf5140a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9f35a631-c594-4259-90e8-8a209d01bcb6",
                "title": "GrayLog: Get Cluster Metrics",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7d8e58fd-5f12-4c4c-b4d0-beeb5bf5140a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Metrics",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "metrics": "jvm.memory.pools.CodeHeap-'non-nmethods'.used"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_metrics",
                "operationTitle": "Get Cluster Metrics",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "85550994-d815-4380-94aa-d63e6b7b8d0b"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Metrics",
              "targetStep": "/api/3/workflow_steps/85550994-d815-4380-94aa-d63e6b7b8d0b",
              "sourceStep": "/api/3/workflow_steps/7d8e58fd-5f12-4c4c-b4d0-beeb5bf5140a",
              "label": null,
              "isExecuted": false,
              "uuid": "1097c2b5-08f7-4a61-9ced-cd5abbecff66"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "a167cde5-b0c3-40c3-ab5f-681c51f6519d",
          "id": 1452,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Clusters",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a list of clusters from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659683842,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5a5c5f59-3e71-411a-a04d-4ad347d3476a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Clusters",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": [],
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_clusters",
                "operationTitle": "Get Clusters",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "4b40ec16-91d4-4251-a952-00521c6cfc0d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "268c55aa-1b1b-424d-a4b0-68d5550280b3",
                "title": "Graylog: Get Clusters",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "5a5c5f59-3e71-411a-a04d-4ad347d3476a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Clusters",
              "targetStep": "/api/3/workflow_steps/4b40ec16-91d4-4251-a952-00521c6cfc0d",
              "sourceStep": "/api/3/workflow_steps/5a5c5f59-3e71-411a-a04d-4ad347d3476a",
              "label": null,
              "isExecuted": false,
              "uuid": "1eba7f7b-f415-480f-943d-35de461b6772"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "af5d73c3-11bf-4468-8eb5-051136a1021b",
          "id": 1453,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Streams",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a list of streams from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684912,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/52e66a93-00a2-47fb-a452-c15aa8b6cbf5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "fcacb7d1-b1a3-42fd-a8b5-77f8bec4135a",
                "title": "GrayLog: Get Streams",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "52e66a93-00a2-47fb-a452-c15aa8b6cbf5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Streams",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": [],
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_streams",
                "operationTitle": "Get Streams",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "eadf9f23-f6ef-4a14-a72c-016470f187c8"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Streams",
              "targetStep": "/api/3/workflow_steps/eadf9f23-f6ef-4a14-a72c-016470f187c8",
              "sourceStep": "/api/3/workflow_steps/52e66a93-00a2-47fb-a452-c15aa8b6cbf5",
              "label": null,
              "isExecuted": false,
              "uuid": "51edc3d3-be26-4a31-8e7a-f1a5e43021e6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "c4cfa3ab-b42e-4949-9b72-6e6c1d117241",
          "id": 1454,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> GrayLog > Fetch Messages",
          "aliasName": null,
          "tag": null,
          "description": "Fetches all messages from Graylog based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659699129,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a603949b-d13b-4244-9fe4-2a8fb4d5d511",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Search Absolute",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "sort": true,
                  "limit": "",
                  "query": "{{vars.query}}",
                  "fields": "",
                  "filter": "",
                  "offset": "",
                  "decorate": true,
                  "end_time": "{{vars.curr_timestamp}}",
                  "start_time": "{{vars.last_pull_time}}"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "search_absolute",
                "operationTitle": "Search Absolute",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7c97d589-658f-4b63-926b-1903a5727a32"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "curr_timestamp": "{{arrow.get( arrow.utcnow().timestamp).strftime('%Y-%m-%dT%H:%M:%S.%fZ')}}",
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.Pull_Sample_Events_in_Past_X_Minutes).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "84447131-bce8-41d8-a632-36ba929e682b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Save Result",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Search_Absolute.data.get(\"messages\", [])}}",
                "macro_name": "{{vars.GrayLogLastAlertPullTime}}",
                "curr_timestamp": "{{vars.curr_timestamp}}"
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "95d17b2d-ec69-44a6-9ec4-75a44c8f4ca4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n{\n    \"title\": \"Query\",\n    \"description\": \"Specify a lucene syntax query based on which you want to search for a messages in a absolute timerange from Graylog.\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"text\",\n    \"name\": \"query\",\n    \"tooltip\": \"Specify a lucene syntax query based on which you want to search for a messages.\"\n},\n{\n    \"title\": \"Pull Incidents from Last X Minutes\",\n    \"name\": \"Pull_Sample_Events_in_Past_X_Minutes\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch incidents from last X minutes. e.g 5\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 10\n  }\n]",
                  "GrayLogLastAlertPullTime": "GrayLogLastAlertPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "a603949b-d13b-4244-9fe4-2a8fb4d5d511"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.GrayLogLastAlertPullTime}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "c0597b94-32ed-436a-a67c-dded735693bd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "query": "example.org",
                "Pull_Sample_Events_in_Past_X_Minutes": "10"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c2d09e10-1d1e-4190-800b-bf2053c3b51a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Environment Setup",
              "description": null,
              "arguments": {
                "when": "{{vars.request.env_setup}}",
                "arguments": {
                  "GrayLogMacroName": "{{vars.GrayLogLastAlertPullTime}}",
                  "GrayLogMacroValue": "0",
                  "overrideIfNoMatch": "false"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/9f0da8c4-e4e6-41b9-9584-38f8a50cbc2c"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "d93c0981-dfb1-462a-9d05-9944419d4dcf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/c2d09e10-1d1e-4190-800b-bf2053c3b51a",
              "sourceStep": "/api/3/workflow_steps/a603949b-d13b-4244-9fe4-2a8fb4d5d511",
              "label": null,
              "isExecuted": false,
              "uuid": "4930a616-297c-4eb2-b8fd-f6389cc05dc4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Environment Setup",
              "targetStep": "/api/3/workflow_steps/d93c0981-dfb1-462a-9d05-9944419d4dcf",
              "sourceStep": "/api/3/workflow_steps/c2d09e10-1d1e-4190-800b-bf2053c3b51a",
              "label": null,
              "isExecuted": false,
              "uuid": "9014078b-3072-4db8-8c9e-261587a93269"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/84447131-bce8-41d8-a632-36ba929e682b",
              "sourceStep": "/api/3/workflow_steps/c0597b94-32ed-436a-a67c-dded735693bd",
              "label": null,
              "isExecuted": false,
              "uuid": "943840bb-db42-428b-b32f-9feaf1068919"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Search Absolute -> Save Result",
              "targetStep": "/api/3/workflow_steps/95d17b2d-ec69-44a6-9ec4-75a44c8f4ca4",
              "sourceStep": "/api/3/workflow_steps/7c97d589-658f-4b63-926b-1903a5727a32",
              "label": null,
              "isExecuted": false,
              "uuid": "c7ea0cd8-0802-4259-8e90-a7a697846bb4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Search Absolute",
              "targetStep": "/api/3/workflow_steps/7c97d589-658f-4b63-926b-1903a5727a32",
              "sourceStep": "/api/3/workflow_steps/84447131-bce8-41d8-a632-36ba929e682b",
              "label": null,
              "isExecuted": false,
              "uuid": "daa39c6c-1ccf-414a-817f-7787f493d737"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Environment Setup -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/c0597b94-32ed-436a-a67c-dded735693bd",
              "sourceStep": "/api/3/workflow_steps/d93c0981-dfb1-462a-9d05-9944419d4dcf",
              "label": null,
              "isExecuted": false,
              "uuid": "ef450cd2-fb90-4ff0-8f30-33c4cc500ec4"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cc9832d6-a0da-4b6c-8664-370c73a47234",
          "id": 1455,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cluster Node Metrics Names",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve all metrics keys/names from node in the cluster from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659684679,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e5be20c4-c976-4708-9587-64061d9b6a80",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Cluster Node Metrics Names",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": {
                  "id": "ea9b90de-65bc-43f5-bd23-1e1a7c3eb5aa"
                },
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_cluster_node_metrics_names",
                "operationTitle": "Get Cluster Node Metrics Names",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c9133f4f-7a21-44e8-9d2e-d489cb6be387"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "fda3ed78-f18e-4f81-b835-7905e6695877",
                "title": "GrayLog: Get Cluster Node Metrics Names",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e5be20c4-c976-4708-9587-64061d9b6a80"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Cluster Node Metrics Names",
              "targetStep": "/api/3/workflow_steps/c9133f4f-7a21-44e8-9d2e-d489cb6be387",
              "sourceStep": "/api/3/workflow_steps/e5be20c4-c976-4708-9587-64061d9b6a80",
              "label": null,
              "isExecuted": false,
              "uuid": "2b45a5e0-624b-484f-b955-2652863d6ade"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cfec8c7d-5981-4f38-91d3-84344dee0a9c",
          "id": 1456,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Indexer Cluster Health",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve a indexer of the cluster health from Graylog.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1659683801,
          "collection": "/api/3/workflow_collections/0096c7e4-a695-45a6-8ee7-1103852ca646",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/cda2505d-ce01-42fd-8d3d-5a26a6cc7b88",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Indexer Cluster Health",
              "description": null,
              "arguments": {
                "name": "Graylog",
                "config": "",
                "params": [],
                "version": "1.0.0",
                "connector": "graylog",
                "operation": "get_indexer_cluster_health",
                "operationTitle": "Get Indexer Cluster Health",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0980e52e-33fa-4535-979d-78f7b51e8299"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ef2a21d6-132e-4d57-8dc4-8ee6291210a4",
                "title": "Graylog: Get Indexer Cluster Health",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "cda2505d-ce01-42fd-8d3d-5a26a6cc7b88"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Indexer Cluster Health",
              "targetStep": "/api/3/workflow_steps/0980e52e-33fa-4535-979d-78f7b51e8299",
              "sourceStep": "/api/3/workflow_steps/cda2505d-ce01-42fd-8d3d-5a26a6cc7b88",
              "label": null,
              "isExecuted": false,
              "uuid": "ca521ffc-7af0-4c2c-ab36-9ca50fe75a0e"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e5e9f67e-125a-4409-b93e-0561e91bda07",
          "id": 1457,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "graylog"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "graylog",
    "dataingestion",
    "create",
    "ingest",
    "fetch"
  ]
}